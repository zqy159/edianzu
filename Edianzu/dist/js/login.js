"use strict";function login(){this.username=$("#username"),this.password=$("#password"),this.btn=$("#btn"),this.input=$("input"),this.nologin=$("#loginFree")}jQuery.cookie=function(e,i,n){if(void 0===i){var s=null;if(document.cookie&&""!=document.cookie)for(var t=document.cookie.split(";"),o=0;o<t.length;o++){var r=jQuery.trim(t[o]);if(r.substring(0,e.length+1)==e+"="){s=decodeURIComponent(r.substring(e.length+1));break}}return s}n=n||{},null===i&&(i="",n.expires=-1);var a,p="";n.expires&&("number"==typeof n.expires||n.expires.toUTCString)&&("number"==typeof n.expires?(a=new Date).setTime(a.getTime()+24*n.expires*60*60*1e3):a=n.expires,p="; expires="+a.toUTCString());var u=n.path?"; path="+n.path:"",c=n.domain?"; domain="+n.domain:"",h=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(i),p,u,c,h].join("")},$.extend(login.prototype,{init:function(){this.username.on("blur",$.proxy(this.usernames,this)),this.password.on("blur",$.proxy(this.passwords,this)),this.btn.on("click",$.proxy(this.btns,this)),this.input.on("click",$.proxy(this.inputs)),this.nlogin(),this.nologin.on("click",$.proxy(this.nologins,this))},inputs:function(){$(this).parent().css("box-shadow","0 0 2px #37a3ff")},usernames:function(e){var i=e.target;$.ajax({url:"http://119.23.200.22/Edianzu/dist/php/select.php",data:{uname:this.username.val()},dataType:"json",success:function(e){e.status?($(i).parent().css("border","1px solid #f00"),$(i).next().show().find("span").html("用户名不存在")):($(i).next().hide(),$(i).parent().css("border","0"))}})},btns:function(){if(this.username.val()&&this.password.val()){var i=this;$.ajax({url:"http://119.23.200.22/Edianzu/dist/php/login.php",data:{uname:i.username.val(),upwd:i.password.val()},dataType:"json",success:function(e){1==e.status&&(i.nologin.prop("checked")&&$.cookie("init",'{"uname":"'+i.username.val()+'","upwd":"'+i.password.val()+'"}',{expires:7}),location.href="../../index.html"),alert(e.info)}})}else alert("请把信息填完整")},nlogin:function(){$.cookie("init")&&(this.nologin.prop("checked","checked"),console.log(JSON.parse($.cookie("init")).uname),this.username.val(JSON.parse($.cookie("init")).uname),this.password.val(JSON.parse($.cookie("init")).upwd))},nologins:function(){this.nologin.prop("checked")?$.cookie("init")?this.nlogin():alert("很抱歉没存值"):(this.username.val(""),this.password.val(""))}}),(new login).init();